<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Example Integration Service</title>

<script type="text/javascript" src="./dist/Wildix.IntegrationService.js"></script>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>

<script type="text/javascript">

var WIService = new Wildix.IntegrationService({
    name: "IBMConnections",
    version: '1.0.0'
});


WIService.on('connection:error', function(){
    // fired when could not connect to WIService
    console.warn('WIService not installed or is not running');
});

WIService.on('ready', function(){
    // fired when connected and received collaboration status
    var status = WIService.getCollaborationStatus();
    if(status == 'disconnected'){
        console.warn('Collaboration not running');
    }
});

WIService.on('collaboration:connected', function(){
    // fired when detected that the collaboration is connected to WIService
    console.log('Collaboration connected');
});

WIService.on('collaboration:disconnected', function(){
    // fired when detected that the collaboration is disconnected from WIService
    console.log('Collaboration disconnected');
});




WIService.Roster.on('all', function(a, b, c, d){
    // fired when collaboration connected and module Roster first received roster
    console.log('Roster =========', a, b, c, d);
});


WIService.Roster.on('reset', function(roster){
    // fired when module Roster received all roster items from Collaboration
    console.log('Received new roster', roster);
});

WIService.Roster.on('update', function(user){
    // fired when updated user or presence
    console.log('Updated user', user);
});

WIService.Roster.on('remove', function(user){
    // fired when deleted user
    console.log('Removed user', user);
});

WIService.Roster.on('add', function(user){
    // fired when added user
    console.log('Added user', user);
});


WIService.Telephony.on('all', function(a, b, c, d){
    // fired when added user
    console.log('Telephony =========', a, b, c, d);
});

// make subscription to roster data
WIService.Roster.subscribe();
WIService.Telephony.subscribe();





//GUI processing
$(document).ready(function(){
    $('#call').on('click', function(){
        var status = WIService.getCollaborationStatus();
        if(status == 'connected'){
            // make call
            if($('#number').val() != ''){
                WIService.Telephony.call($('#number').val());
            }
        }else{
            console.warn('Collaboration not running');
        }
    });

    $('#chat').on('click', function(){
        var status = WIService.getCollaborationStatus();
        if(status == 'connected'){
            // open chat
            if($('#number').val() != ''){
                WIService.Chat.open($('#number').val());
            }
        }else{
            console.warn('Collaboration not running');
        }
    });
});





</script>
</head>
<body>

<input type="text" id="number"> <input type="button" id="call" value="Call" /> <input type="button" id="chat" value="Chat" />

</body>
</html>
